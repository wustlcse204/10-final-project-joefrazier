(this["webpackJsonp10-final-project-joefrazier"]=this["webpackJsonp10-final-project-joefrazier"]||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},18:function(e,t,n){e.exports=n(31)},23:function(e,t,n){},25:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(17),s=n.n(r),i=(n(23),n(6)),c=n.n(i),l=n(8),u=n(2),p=n(3),d=n(5),m=n(4),h=(n(25),n(7)),g=n.n(h);n(26),n(28);g.a.initializeApp({apiKey:"AIzaSyCqef48hVI-52yHHE5ZdVIpXtEIQFoie_Y",authDomain:"git-social-v1.firebaseapp.com",databaseURL:"https://git-social-v1.firebaseio.com",projectId:"git-social-v1",storageBucket:"git-social-v1.appspot.com",messagingSenderId:"979995074373",appId:"1:979995074373:web:a47830151a144caccea82c"});var f=g.a.auth(),v=g.a.firestore();function b(){return k.apply(this,arguments)}function k(){return(k=Object(l.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new g.a.auth.GithubAuthProvider).addScope("user:read"),e.next=4,g.a.auth().signInWithPopup(t).then((function(e){n=e.credential.accessToken;e.user})).catch((function(e){var t=e.code;e.message,e.email,e.credential;"auth/account-exists-with-different-credential"===t?alert("You have already signed up with a different auth provider for that email."):console.error(e)}));case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(15);var E=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(u.a)(this,n),t.call(this,e)}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"login-container"},o.a.createElement("h2",null,"Login/Register"),o.a.createElement("input",{type:"button",className:"login-input log-btn",id:"login-btn",onClick:this.props.onClick,value:"Login with GitHub"}))}}]),n}(a.Component),N=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(u.a)(this,n),t.call(this,e)}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"logout-container"},o.a.createElement("input",{type:"button",className:"login-input log-btn",id:"login-btn",onClick:this.props.onClick,value:"Logout"}))}}]),n}(a.Component),w=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"largeheader-container"},o.a.createElement("h1",{className:"large-text"},"GitSocial"))}}]),n}(a.Component),y=(n(16),function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).handlePost=function(){a.props.onClick(JSON.stringify(a.props.repo)),console.log(a.props.repo)},a}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"repo-item-container"},o.a.createElement("div",{className:"repo-item-name"},this.props.name),o.a.createElement("div",{className:"repo-item-owner"},this.props.owner),o.a.createElement("div",{className:"repo-item-description"},this.props.description),o.a.createElement("input",{type:"button",className:"postRepoBtn",value:"Post",onClick:this.handlePost}))}}]),n}(a.Component)),O=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).renderReadme=function(){var e=a.props.repoID,t=a.props.readme;console.log(a.props.readme),document.getElementById(e).innerHTML=t},a}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"post-item"},o.a.createElement("div",{className:"post-header"},o.a.createElement("div",{className:"post-header-1"},o.a.createElement("img",{className:"post-owner-pic",src:this.props.ownerPic})),o.a.createElement("div",{className:"post-header-2"},o.a.createElement("div",{className:"post-name"},this.props.name),o.a.createElement("div",{className:"post-owner"},this.props.owner),o.a.createElement("div",{className:"post-link"},o.a.createElement("a",{className:"post-link-href",href:this.props.link},"View")))),o.a.createElement("div",{className:"post-readme",id:this.props.repoID},this.props.readme))}},{key:"componentDidMount",value:function(){this.renderReadme()}}]),n}(a.Component),S=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).getReadme=function(e){var t=e.name,n=e.owner.login;console.log("login: "+n),console.log("login: "+t);var o=a.state.accessToken,r="https://api.github.com/repos/"+n+"/"+t+"/readme",s=new XMLHttpRequest,i=a.getReadmeCallback;s.onreadystatechange=function(){4===this.readyState?i(this,e):(console.log(this),console.log("Repo does not contain a readme"))},s.open("GET",r,!0),s.setRequestHeader("Content-type","application/vnd.github.v3.raw"),s.setRequestHeader("Authorization","token "+o),s.send()},a.getReadmeCallback=function(e,t){var n=JSON.parse(e.responseText).content;if(void 0!==n){var o=atob(n);a.readmeToHTML(o,t)}else console.log("Get Readme Callback error")},a.readmeToHTML=function(e,t){var n={text:e,mode:"markdown"},o=a.addReadmeToDB;n=JSON.stringify(n);var r=new XMLHttpRequest;r.onreadystatechange=function(){4===this.readyState?o(this.responseText,t):console.log("Readme To Html Error")},r.open("POST","https://api.github.com/markdown",!0),r.setRequestHeader("Content-type","text/plain"),r.setRequestHeader("Authorization","token "+a.state.accessToken),r.send(n)},a.addReadmeToDB=function(e,t){console.log("Add read me"),v.collection("posts").doc(t.id.toString()).set({repoID:t.id,readme:e,ownerUID:a.state.uid.toString(),ownerPic:a.state.userGHPic,repoName:t.name,owner:t.owner.login,link:t.html_url,clone:t.clone_url,language:t.language,description:t.description}).then((function(){console.log("Readme posted successfully")}))},a.loadUserReposCallback=function(e){for(var t=v,n=0;n<e.length;++n)t.collection(a.state.uid.toString()).doc(e[n].id.toString()).set({repoID:e[n].id.toString(),repoName:e[n].name,link:e[n].html_url,description:e[n].description,clone:e[n].clone_url,language:e[n].language,owner:e[n].owner.login,ownerPic:a.state.userGHPic,repo:e[n]},{merge:!0}).then((function(){console.log("success")}))},a.loadUserRepos=function(){var e=a.loadUserReposCallback,t=new XMLHttpRequest;t.onreadystatechange=function(){4===this.readyState?e(JSON.parse(this.responseText)):console.log("Error")},t.open("GET","https://api.github.com/user/repos?visibility=public",!0),t.setRequestHeader("Content-type","application/json"),t.setRequestHeader("Authorization","token "+a.state.accessToken),t.send()},a.onClickHandler=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:t=e.sent,a.setState({accessToken:t}),a.requestUsername(t);case 5:case"end":return e.stop()}}),e)}))),a.onClickHandlerOut=Object(l.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({isLoggedIn:!1}),g.a.auth().signOut().then((function(){})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)}))),a.requestUsername=function(e){var t=a.setUserState,n=new XMLHttpRequest;n.onreadystatechange=function(){4===this.readyState?t(JSON.parse(this.responseText)):console.log("Error")},n.open("GET","https://api.github.com/user",!0),n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("Authorization","token "+e),n.send()},a.setUserState=function(e){a.setState({userGHLogin:e.login,userGHPic:e.avatar_url,userGH:e.url,userGHBio:e.bio,userGHReposUrl:e.repos_url}),a.loadUserRepos()},a.postRepo=function(e){var t=JSON.parse(e);a.getReadme(t)},a.renderPosts=function(e){console.log("LISTS: "+JSON.stringify(e[0])),a.setState({posts:e})},a.renderRepoList=function(e){a.setState({repos:e})},a.state={isLoggedIn:!1,username:"",userName:"",uid:"",userEmail:"",accessToken:"",repos:[],userGHLogin:"",userGHPic:"",userGH:"",userGHBio:"",userGHReposUrl:"",posts:[]},a}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return this.state.isLoggedIn?o.a.createElement("div",{className:"App"},o.a.createElement(w,null),o.a.createElement(N,{onClick:this.onClickHandlerOut}),o.a.createElement("div",{className:"main-container"},o.a.createElement("div",{id:"post-container"},this.state.posts.map((function(e){return o.a.createElement(O,{key:e.repoID,repoID:e.repoID,name:e.repoName,owner:e.owner,readme:e.readme,ownerPic:e.ownerPic,link:e.link})}))),o.a.createElement("div",{className:"user-repos"},this.state.repos.map((function(t){return o.a.createElement(y,{key:t.repoID,name:t.repoName,owner:t.owner,description:t.description,repo:t.repo,onClick:e.postRepo})}))))):o.a.createElement("div",{className:"App"},o.a.createElement(w,null),o.a.createElement(E,{onClick:this.onClickHandler}))}},{key:"componentDidMount",value:function(){var e=this,t=v,n=[],a=this.renderPosts,o=this.renderRepoList,r=[];f.onAuthStateChanged((function(s){if(n=[],null!==f.currentUser){JSON.parse(JSON.stringify(s));e.setState({isLoggedIn:!0,userName:s.displayName,uid:s.uid,userEmail:s.email}),t.collection("posts").onSnapshot((function(e){n=[],e.forEach((function(e){n.push(e.data())})),console.log("SETTING POST LIST"),a(n)})),t.collection(s.uid).onSnapshot((function(e){r=[],e.docChanges().forEach((function(e){r.push(e.doc.data())})),o(r)}))}else e.setState({isLoggedIn:!1,username:"",userName:"",uid:"",userEmail:"",accessToken:"",repos:[],userGHLogin:"",userGHPic:"",userGH:"",userGHBio:"",userGHReposUrl:""})}))}}]),n}(a.Component);s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(S,null)),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.b2a90e80.chunk.js.map